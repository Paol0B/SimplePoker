/* Miglioramento UI moderna, semplice e chiara */
:root {
  --bg: #181c24;
  --felt1: #2e7d5a;
  --felt2: #174c36;
  --edge: #1a3a2a;
  --text: #f8fafc;
  --muted: #b0b8c1;
  --accent: #ffd700;
  --bet: #ff5252;
  --chip-white: #f8fafc;
  --chip-red: #ff5252;
  --chip-green: #43ea7c;
  --chip-blue: #3b82f6;
  --chip-black: #222;
  --turn: #43ea7c;
  --seatGlow: rgba(67,234,124,.25);
  --radius: 18px;
  --shadow: 0 8px 32px rgba(0,0,0,.22);
  --table-width: 1200px;
  --table-height: 700px;
}
* { box-sizing: border-box; }
body {
  margin: 0;
  font-family: 'Inter', ui-sans-serif, system-ui, Arial, sans-serif;
  background: linear-gradient(120deg, #181c24 0%, #174c36 100%);
  color: var(--text);
  min-height: 100vh;
  display: flex;
  flex-direction: column;
}
.topbar {
  display: flex; gap: 1rem; align-items: center; padding: 1rem 2rem;
  background: rgba(30,40,50,.85); border-bottom: 1px solid #222;
  position: sticky; top: 0; z-index: 10;
  box-shadow: var(--shadow);
}
.brand {
  font-weight: 900; font-size: 1.3rem; letter-spacing: 1px; color: var(--accent);
}
.topbar input {
  background: #222; border: 1px solid #333; color: var(--text);
  padding: .6rem 1rem; border-radius: var(--radius); font-size: 1rem;
  min-width: 120px;
}
.topbar button {
  background: var(--accent); color: #222; border: 0; border-radius: var(--radius);
  padding: .6rem 1.2rem; font-weight: 700; cursor: pointer; font-size: 1rem;
  transition: background .2s;
}
.topbar button:disabled { opacity: .5; cursor: not-allowed; }
#status { margin-left: auto; color: var(--muted); font-size: 1rem; }
.hidden { display: none; }
main#tableWrap {
  width: 100vw;
  min-height: 200vh;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: flex-start;
  padding-top: 1rem;
}
.table {
  position: relative;
  width: var(--table-width);
  height: var(--table-height);
  margin: 2rem auto 0 auto;
  aspect-ratio: 16/9;
  background: radial-gradient(110% 110% at 50% 50%, var(--felt1), var(--felt2));
  border-radius: 50%/35%;
  border: 14px solid var(--edge);
  box-shadow: var(--shadow), 0 20px 60px rgba(0,0,0,.35);
  overflow: visible; /* permetti elementi figli ad uscire dal bordo del tavolo */
  z-index: 0; /* TAVOLO: ultimo piano */
}
.felt { position: absolute; inset: 0; pointer-events: none; background: radial-gradient(60% 30% at 50% 50%, rgba(255,255,255,.04), transparent); }
.glow { position: absolute; inset: 7% 12%; border: 2px solid rgba(255,255,255,.07); border-radius: 50%/35%; box-shadow: inset 0 0 80px rgba(0,0,0,.3); pointer-events: none; }
.pot-area {
  position: absolute; left: 50%; top: 50%; transform: translate(-50%, -50%);
  display: flex; flex-direction: column; align-items: center; gap: .4rem; z-index: 6;
  font-size: 1.25rem;
}
.pot-info { color: var(--muted); font-weight: 700; font-size: 1.1rem; }
#stage { color: var(--accent); font-weight: 700; }
.dealer-btn {
  position: absolute; width: 32px; height: 32px; border-radius: 50%; background: var(--accent); color: #222; font-weight: 900; display: grid; place-items: center;
  box-shadow: 0 4px 10px rgba(0,0,0,.25); z-index: 7; transform: translate(-50%, -50%);
  font-size: 1.1rem;
}
.seats {
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
  pointer-events: none; /* evita che l'area globale catturi click; i singoli .seat avranno pointer-events */
  z-index: 2;
}
.seat {
  position: absolute; width: 18%; min-width: 160px; max-width: 300px; display: flex; flex-direction: column; align-items: center; gap: .4rem;
  transform: translate(-50%, -50%); transition: box-shadow .2s;
  background: rgba(30,40,50,.12); border-radius: var(--radius);
  box-shadow: 0 2px 8px rgba(0,0,0,.08);
  padding: .6rem 0;
  pointer-events: auto; /* i singoli posti sono interattivi */
  z-index: 3; /* sopra il tavolo */
}
.seat.turn { box-shadow: 0 0 0 6px var(--seatGlow); border-radius: var(--radius); }
.seat .head { display: flex; justify-content: space-between; align-items: center; width: 100%; gap: .7rem; }
.seat .name { font-weight: 800; font-size: 1.05rem; }
.seat .flags { display: flex; gap: .5rem; align-items: center; }
.turn-icon { color: var(--turn); font-size: 1.2rem; }
.fold { color: #bbb; font-style: italic; font-size: .95rem; }
.cards { display: flex; gap: .5rem; }
.card {
  width: 62px; height: 90px; border-radius: 10px; background: #fff; color: #222;
  display: grid; place-items: center; font-weight: 800; font-size: 1.15rem;
  box-shadow: 0 6px 16px rgba(0,0,0,.22);
  user-select: none; border: 2px solid #eee;
  transition: transform .12s, outline-color .12s, border-color .12s;
  position: relative;
  z-index: 4; /* sopra il tavolo, sotto toasts */
}
.card.red { color: #c22; }
.card.back { background: repeating-linear-gradient(45deg, #224, #224 8px, #335 8px, #335 16px); color: transparent; border: 2px solid #bbb; }
.cards.selectable .card { cursor: pointer; outline: 2px solid transparent; }
.cards.selectable .card.selected { transform: translateY(-10px); outline-color: var(--accent); border-color: var(--accent); }
.bet-area { min-height: 28px; display: flex; gap: .4rem; align-items: center; }
.bet-amt { color: var(--bet); font-weight: 700; min-width: 48px; font-size: 1.05rem; }
.stack { display: flex; gap: .4rem; align-items: center; color: var(--muted); font-size: .98rem; }
.chip-stack { display: flex; align-items: flex-end; gap: 2px; min-height: 26px; }
.chip {
  --c: var(--chip-white);
  width: 22px; height: 22px; border-radius: 50%; background: var(--c);
  box-shadow: inset 0 0 0 3px rgba(255,255,255,.7), inset 0 0 0 6px rgba(0,0,0,.18), 0 2px 4px rgba(0,0,0,.22);
  position: relative; display: grid; place-items: center; font-size: .65rem; font-weight: 900; color: #222;
}
.chip.red { --c: var(--chip-red); color: #fff; }
.chip.green { --c: var(--chip-green); }
.chip.blue { --c: var(--chip-blue); color: #fff; }
.chip.black { --c: var(--chip-black); color: #fff; box-shadow: inset 0 0 0 3px rgba(255,255,255,.12), inset 0 0 0 6px rgba(255,255,255,.04), 0 2px 4px rgba(0,0,0,.32); }
.chip + .chip { margin-left: -10px; }
.actions {
  max-width: var(--table-width);
  margin: 2rem auto 0 auto;
  padding: 1.2rem 2rem;
  font-size: 1.15rem;
  display: flex; justify-content: space-between; align-items: center; gap: 1.2rem; flex-wrap: wrap;
  background: rgba(30,40,50,.10); border-radius: var(--radius); box-shadow: 0 2px 8px rgba(0,0,0,.08);
  z-index: 200; position: relative;
}
.act {
  background: var(--felt1); border: 0; color: #fff; padding: .7rem 1.2rem; border-radius: var(--radius); cursor: pointer; min-width: 120px; font-size: 1.05rem; font-weight: 700;
  box-shadow: 0 2px 8px rgba(0,0,0,.08);
  transition: background .2s;
}
/* bet control */
.bet-control { display: inline-flex; gap: .4rem; align-items: center; margin-left: .6rem; }
.bet-control input[type='number'] { width: 5.2rem; padding: .35rem .5rem; border-radius: .4rem; border: 1px solid rgba(0,0,0,.08); }
.bet-control .small { padding: .35rem .6rem; font-size: .85rem; }
.hidden { display: none !important; }
.act:disabled { opacity: .45; cursor: not-allowed; }
.act.alt { background: #222; color: var(--accent); }
.hint { color: var(--muted); font-size: .98rem; }
.msg {
  max-width: var(--table-width);
  margin: 2rem auto 2rem auto;
  font-size: 1.18rem;
  text-align: center; font-weight: 700;
  background: rgba(30,40,50,.10); border-radius: var(--radius); padding: .7rem 1.2rem;
  z-index: 200; position: relative;
}
.toasts {
  position: fixed; left: 50%; bottom: 24px; transform: translateX(-50%); display: flex; flex-direction: column; gap: .5rem; z-index: 10000;
}
.toast {
  background: rgba(30,40,50,.92); border: 1px solid rgba(255,255,255,.08); color: var(--accent); padding: .7rem 1.2rem; border-radius: var(--radius);
  font-weight: 700; font-size: 1.05rem;
  animation: fadeSlide 2.2s ease forwards;
}
@keyframes fadeSlide {
  0% { opacity: 0; transform: translate(-50%, 10px); }
  10% { opacity: 1; transform: translate(-50%, 0); }
  90% { opacity: 1; }
  100% { opacity: 0; transform: translate(-50%, -6px); }
}
.avatar {
  width: 38px; height: 38px; position: relative; border-radius: 50%; background: #f8e0c9; overflow: hidden; border: 2px solid rgba(0,0,0,.12);
  box-shadow: 0 2px 8px rgba(0,0,0,.10);
}
.hair {
  position: absolute; width: 110%; height: 60%; top: -6%; left: -5%; border-bottom-left-radius: 60% 80%; border-bottom-right-radius: 60% 80%;
  background: #333;
}
.face { position: absolute; inset: 0; display: grid; place-items: center; color: #000; opacity: .25; font-size: .8rem; }
.seat[data-idx="0"] { left: 50%; top: 7%; }
.seat[data-idx="1"] { left: 85%; top: 22%; }
.seat[data-idx="2"] { left: 92%; top: 70%; }
.seat[data-idx="3"] { left: 50%; top: 93%; }
.seat[data-idx="4"] { left: 8%; top: 70%; }
.seat[data-idx="5"] { left: 15%; top: 22%; }
.add-bot-btn {
  background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(0,0,0,.06));
  border: 1px solid rgba(255,255,255,.04);
  color: var(--muted);
  border-radius: 10px;
  cursor: pointer;
}
.add-bot-btn:hover { color: var(--text); border-color: rgba(255,255,255,.12); }
@media (max-width: 1300px) {
  :root {
    --table-width: 98vw;
    --table-height: 60vw;
  }
}
@media (max-width: 900px) {
  :root {
    --table-width: 100vw;
    --table-height: 80vw;
  }
  .seat { min-width: 120px; }
}
